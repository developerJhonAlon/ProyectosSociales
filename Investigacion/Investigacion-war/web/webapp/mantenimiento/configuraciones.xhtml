<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:pe="http://primefaces.org/ui/extensions"
      >
    <h:body>    
        <ui:composition template="/vista/template-sistema2.xhtml">
            <ui:define name="content">

                <style>
                    .ui-panel .ui-panel-content {
                        padding: 0;
                    }            
                    .col1_datos_generales {
                        width: 65px;
                    }
                    .col1_adquisicion {
                        width: 95px;
                    }
                    .col1_objetivos {
                        width: 80px;
                    }
                    .col1_presupuesto {
                        width: 125px;
                    }
                    .col1_identificacionPoblacion {
                        width: 70px;
                        text-align: left;
                        border: solid;
                        border-width: 1px;
                    }
                    .col2_identificacionPoblacion {
                        width: 70px;
                        text-align: center;
                        border: solid;
                        border-width: 1px;
                    }
                    .col1_acta_concejo_departamento{
                        width: 200px;
                    }
                    .hide-column-names table thead tr {
                        display: none;
                    }
                    .button {

                        background-color: Transparent;background-repeat:no-repeat;border: none;cursor:pointer;overflow: hidden;

                    }           
                    .inputNumber2 input
                    {
                        width: 25px;
                    }
                    .alineadoCentro{
                        text-align: center;
                    }

                </style>                
                <p:panel header="Configuraciones Generales" style="border: hidden; margin-bottom: 110px">
                    <h:panelGrid columns="3" columnClasses="menu, alineadoSuperior,alineadoSuperior" style="width: 100%">
                        <h:panelGrid id="panelMenu" columns="1" style="margin-top: 10px">
                            <p:tree id="treeMenu" value="#{configuracionesController.opcionesMenu}" var="opcion"
                                    selectionMode="single"
                                    selection="#{configuracionesController.opcionMenuSelected}"
                                    style="width: 201px"
                                    >
                                <p:ajax event="select" listener="#{configuracionesController.onMenuSelect}" update=":formPrincipal:panelCentral"
                                        onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"/>
                                <p:treeNode styleClass="menuOpciones2">
                                    <h:outputText value="#{opcion.nombre}" style="white-space: pre-line" />
                                </p:treeNode>
                            </p:tree>

                        </h:panelGrid>

                        <p:panel id="panelCentral" style="width: 98%; border: hidden ">



                            <!--panelConfigParametrosEvaluacion-->
                            <p:panel id="panelConfigParametrosEvaluacion" rendered="#{configuracionesController.opcionMenuCodeSelected=='1'}" style="border: hidden; margin-left: 20px;">
                                <h:panelGrid id="panelEdicionConfigParametrosEvaluacion" columns="1" style="width: 100%;">
                                    <p:focus context="panelEdicionConfigParametrosEvaluacion"/>
                                    <h:panelGrid columns="1" style="width: 100%"
                                                 rendered="#{configuracionesController.configuracionParametrosEvaluacionSelected==null and configuracionesController.parametroEvaluacionSelected==null and configuracionesController.valoracionParametroEvaluacionSelected==null}">
                                        <p:commandButton value="Agregar" title="Agregar Configuración de Parámetros de Evaluación" icon="ui-icon-plus" 
                                                         update=":formPrincipal:panelEdicionConfigParametrosEvaluacion"
                                                         actionListener="#{configuracionesController.nuevoConfiguracionParametrosEvaluacion}" 
                                                         >
                                        </p:commandButton>
                                        <p:messages rendered="false" autoUpdate="true" closable="true"/>
                                    </h:panelGrid>
                                    <h:panelGrid style="width: 100%"
                                                 rendered="#{configuracionesController.configuracionParametrosEvaluacionSelected !=null and configuracionesController.parametroEvaluacionSelected==null}">
                                        <p:fieldset 
                                            legend="#{configuracionesController.configuracionParametrosEvaluacionSelected.id==null ? 'NUEVA CONFIGURACION DE PARAMETROS DE EVALUACION':'EDICION DE CONFIGURACION DE PARAMETROS DE EVALUACION'}">
                                            <h:panelGrid columns="2" cellpadding="0" cellspacing="5" style="margin-top: 10px; margin-bottom: 10px">
                                                <p:commandButton id="btnGrabarConfigParametrosEvaluacion" value="Grabar" title="Grabar Información" icon="ui-icon-locked" 
                                                                 update=":formPrincipal:panelConfigParametrosEvaluacion, :formPrincipal:message1" 
                                                                 action ="#{configuracionesController.grabarConfiguracionParametrosEvaluacion}"
                                                                 onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()">
                                                </p:commandButton>
                                                <p:commandButton value="Cancelar" title="Cancela Información" icon="ui-icon-arrowreturnthick-1-w" 
                                                                 process="@this"
                                                                 update=":formPrincipal:panelConfigParametrosEvaluacion" 
                                                                 action="#{configuracionesController.cancelarEdicionConfiguracionParametrosEvaluacion(true)}">
                                                </p:commandButton>
                                            </h:panelGrid>                                          

                                            <h:panelGrid columns="2" cellpadding="0" cellspacing="0" style="margin-bottom: 10px">
                                                <p:outputLabel for="txtDescConfigParametrosEvaluacion" value="* Descripción:" style="font-weight: bold"></p:outputLabel>
                                                <h:panelGrid columns="2">
                                                    <p:inputTextarea id="txtDescConfigParametrosEvaluacion" value="#{configuracionesController.configuracionParametrosEvaluacionSelected.descripcion}"
                                                                     cols="100" rows="3" maxlength="100"
                                                                     disabled="#{!configuracionesController.permitirEdicionConfigParametroEvaluacion}"
                                                                     required="#{not empty param['formPrincipal:btnGrabarConfigParametrosEvaluacion']}">
                                                    </p:inputTextarea>
                                                    <p:message for="txtDescConfigParametrosEvaluacion"></p:message>
                                                </h:panelGrid>

                                                <p:outputLabel for="txtPuntajeMinimoConfigParametrosEvaluacion" value="* Puntaje mínimo requerido:" style="font-weight: bold"></p:outputLabel>
                                                <h:panelGrid columns="2">
                                                    <pe:inputNumber id="txtPuntajeMinimoConfigParametrosEvaluacion" value="#{configuracionesController.configuracionParametrosEvaluacionSelected.puntajeMinimoRequerido}" 
                                                                    decimalPlaces="2" minValue="0" maxlength="2" maxValue="99" styleClass="inputNumber2"
                                                                    disabled="#{!configuracionesController.permitirEdicionConfigParametroEvaluacion}"
                                                                    required="#{not empty param['formPrincipal:btnGrabarConfigParametrosEvaluacion']}">
                                                    </pe:inputNumber>
                                                    <p:message for="txtPuntajeMinimoConfigParametrosEvaluacion"></p:message>
                                                </h:panelGrid>

                                                <p:outputLabel for="selEstadoActivoConfigParametrosEvaluacion" value="* Activa:" style="font-weight: bold"></p:outputLabel>
                                                <h:panelGrid columns="2">
                                                    <p:selectBooleanCheckbox id="selEstadoActivoConfigParametrosEvaluacion" value="#{configuracionesController.estadoActivoConfiguracionParametros}">
                                                    </p:selectBooleanCheckbox>
                                                    <p:message for="selEstadoActivoConfigParametrosEvaluacion"></p:message>
                                                </h:panelGrid>                                                


                                            </h:panelGrid>

                                        </p:fieldset>

                                    </h:panelGrid>

                                    <h:panelGrid style="width: 100%"
                                                 rendered="#{configuracionesController.parametroEvaluacionSelected !=null and configuracionesController.valoracionParametroEvaluacionSelected ==null}">
                                        <p:fieldset 
                                            legend="#{configuracionesController.parametroEvaluacionSelected.id==null ? 'NUEVO PARAMETRO DE EVALUACION':'EDICION DE PARAMETRO DE EVALUACION'}">
                                            <h:panelGrid columns="2" cellpadding="0" cellspacing="5" style="margin-top: 10px; margin-bottom: 10px">
                                                <p:commandButton id="btnGrabarParametroEvaluacion" value="Grabar" title="Grabar Información" icon="ui-icon-locked" 
                                                                 update=":formPrincipal:panelConfigParametrosEvaluacion" 
                                                                 action ="#{configuracionesController.grabarParametroEvaluacion}"
                                                                 onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()">
                                                </p:commandButton>
                                                <p:commandButton value="Cancelar" title="Cancela Información" icon="ui-icon-arrowreturnthick-1-w" 
                                                                 update=":formPrincipal:panelConfigParametrosEvaluacion" 
                                                                 action="#{configuracionesController.cancelarEdicionConfiguracionParametrosEvaluacion(true)}">
                                                </p:commandButton>
                                            </h:panelGrid>                                          
                                            <p:messages autoUpdate="true" closable="true"/>
                                            <h:panelGrid id="panelDatosParametro" columns="2" cellpadding="0" cellspacing="0" style="margin-bottom: 10px">

                                                <p:outputLabel for="txtDescripcionParamEvaluacion" value="* Descripción:" style="font-weight: bold"></p:outputLabel>
                                                <h:panelGrid columns="2">
                                                    <p:inputTextarea id="txtDescripcionParamEvaluacion" value="#{configuracionesController.parametroEvaluacionSelected.descripcion}"
                                                                     cols="100" rows="3" maxlength="500"
                                                                     required="#{not empty param['formPrincipal:btnGrabarParametroEvaluacion']}">
                                                    </p:inputTextarea>
                                                    <p:message for="txtDescripcionParamEvaluacion" showDetail="true" showSummary="false"></p:message>
                                                </h:panelGrid>


                                                <p:outputLabel value="* Tiene SubParámetros?:" for="selTieneSubitems" style="font-weight: bold" rendered="#{configuracionesController.parametroEvaluacionPadreSelected==null}"/>
                                                <h:panelGrid columns="2" rendered="#{configuracionesController.parametroEvaluacionPadreSelected==null}">
                                                    <p:selectOneRadio id="selTieneSubitems" value="#{configuracionesController.parametroEvaluacionSelected.tieneSubitems}" 
                                                                      required="#{not empty param['formPrincipal:btnGrabarParametroEvaluacion']}"
                                                                      >
                                                        <f:selectItem itemLabel="Si" itemValue="S"/>
                                                        <f:selectItem itemLabel="No" itemValue="N"/>
                                                        <p:ajax update=":formPrincipal:panelDatosParametro" process=":formPrincipal:panelDatosParametro" onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"/>
                                                    </p:selectOneRadio>
                                                </h:panelGrid>     

                                                <p:outputLabel for="txtPuntajeMaximoParamEvaluacion" value="* Puntaje máximo:" style="font-weight: bold"
                                                               rendered="#{configuracionesController.parametroEvaluacionSelected.tieneSubitems=='N'}"></p:outputLabel>
                                                <h:panelGrid columns="2" rendered="#{configuracionesController.parametroEvaluacionSelected.tieneSubitems=='N'}">
                                                    <pe:inputNumber id="txtPuntajeMaximoParamEvaluacion" value="#{configuracionesController.parametroEvaluacionSelected.puntajeMaximo}" 
                                                                    decimalPlaces="2" minValue="0" maxlength="2" maxValue="99" styleClass="inputNumber2"
                                                                    disabled="#{configuracionesController.parametroEvaluacionSelected.valoracionList !=null and configuracionesController.parametroEvaluacionSelected.valoracionList.size()>0}"
                                                                    required="#{not empty param['formPrincipal:btnGrabarParametroEvaluacion']}">
                                                    </pe:inputNumber>
                                                    <p:message for="txtPuntajeMaximoParamEvaluacion"></p:message>
                                                </h:panelGrid>


                                            </h:panelGrid>
                                        </p:fieldset>

                                    </h:panelGrid>

                                    <h:panelGrid style="width: 100%"
                                                 rendered="#{configuracionesController.valoracionParametroEvaluacionSelected!=null}">
                                        <p:fieldset legend="#{configuracionesController.valoracionParametroEvaluacionSelected.id ==null ? 'NUEVA VALORACION DE PARAMETRO DE EVALUACION':'EDICION DE VALORACION DE PARAMETRO DE EVALUACION'}">
                                            <h:panelGrid columns="2" cellpadding="0" cellspacing="5" style="margin-top: 10px; margin-bottom: 10px">
                                                <p:commandButton id="btnGrabarValoracionParametro" value="Grabar" title="Grabar Información" icon="ui-icon-locked" 
                                                                 update=":formPrincipal:panelConfigParametrosEvaluacion, :formPrincipal:message1" 
                                                                 action ="#{configuracionesController.grabarValoracionParametro()}"
                                                                 onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()">
                                                </p:commandButton>
                                                <p:commandButton value="Cancelar" title="Cancela Información" icon="ui-icon-arrowreturnthick-1-w" 
                                                                 process="@this"
                                                                 update=":formPrincipal:panelConfigParametrosEvaluacion" 
                                                                 action="#{configuracionesController.cancelarEdicionConfiguracionParametrosEvaluacion(true)}">
                                                </p:commandButton>
                                            </h:panelGrid>                                          

                                            <h:panelGrid columns="2" cellpadding="0" cellspacing="0" style="margin-bottom: 10px">
                                                <p:outputLabel for="txtDescripcionValoracionParam" value="* Descripción:" style="font-weight: bold"></p:outputLabel>
                                                <h:panelGrid columns="2">
                                                    <p:inputText id="txtDescripcionValoracionParam" style="width: 300px" maxlength="100"
                                                                 value="#{configuracionesController.valoracionParametroEvaluacionSelected.descripcion}"
                                                                 required="#{not empty param['formPrincipal:btnGrabarValoracionParametro']}"></p:inputText>
                                                    <p:message for="txtDescripcionValoracionParam"></p:message>
                                                </h:panelGrid>

                                                <p:outputLabel for="txtPuntajeValoracionParam" value="* Puntaje:" style="font-weight: bold"></p:outputLabel>
                                                <h:panelGrid columns="2">
                                                    <pe:inputNumber id="txtPuntajeValoracionParam" value="#{configuracionesController.valoracionParametroEvaluacionSelected.puntaje}" 
                                                                    decimalPlaces="2" minValue="0" maxlength="2" maxValue="99" styleClass="inputNumber2"
                                                                    required="#{not empty param['formPrincipal:btnGrabarValoracionParametro']}">
                                                    </pe:inputNumber>
                                                    <p:message for="txtPuntajeValoracionParam"></p:message>
                                                </h:panelGrid>

                                            </h:panelGrid>
                                        </p:fieldset>

                                    </h:panelGrid>                                    


                                    <p:message for="lblConfig"></p:message>                                    

                                </h:panelGrid>

                                <h:panelGrid>
                                    <h:outputLabel id="lblConfig" value="Configuraciones de parámetros de evaluación:" style="font-weight: bold"/>
                                    <p:dataTable id="dtConfigParametrosEvaluacion" value="#{configuracionesController.configuracionParametrosEvaluacionList}" var="configParametrosEvaluacion"
                                                 expandedRow="#{configParametrosEvaluacion.expanded}" rowIndexVar="index"  resizableColumns="true"
                                                 emptyMessage="No se encontraron resultados">
                                        <p:ajax event="rowToggle" listener="#{configuracionesController.onRowToggleConfigParametroEvaluacion}"/>
                                        <p:column width="20">
                                            <p:rowToggler/>
                                        </p:column>
                                        <p:column headerText="Nro." width="20" >
                                            <h:outputText value="#{index + 1}"/>
                                        </p:column>
                                        <p:column headerText="Fecha creación" width="80" style=" text-align: center;white-space: pre-line">
                                            <h:outputText value="#{configParametrosEvaluacion.fechaConfiguracion}">
                                                <f:convertDateTime pattern="dd/MM/yyyy"/> 
                                            </h:outputText>
                                        </p:column>
                                        <p:column headerText="Descripción">
                                            <h:outputText value="#{configParametrosEvaluacion.descripcion}" style="white-space: pre-line"></h:outputText>
                                        </p:column>
                                        <p:column headerText="Puntaje mínimo requerido" width="80" style="text-align: center; white-space: pre-line">
                                            <h:outputText value="#{configParametrosEvaluacion.puntajeMinimoRequerido}">
                                                <f:convertNumber locale="es"  pattern="#,###,##0.00" />
                                            </h:outputText>
                                        </p:column>
                                        <p:column headerText="Activa" width="40" style="text-align: center;">
                                            <p:selectBooleanCheckbox value="#{configParametrosEvaluacion.estadoActiva}" disabled="true">
                                            </p:selectBooleanCheckbox>
                                        </p:column>


                                        <p:column headerText="Crear Nueva Configuración (replicar)" width="80" style ="text-align: center;white-space: pre-line">
                                            <p:commandButton icon="ui-icon-plus"
                                                             title="Crear una nueva configuración a partir de ésta"
                                                             action="#{configuracionesController.clonarConfiguracionParametrosEvaluacion()}"
                                                             onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                             update=":formPrincipal:panelConfigParametrosEvaluacion, :formPrincipal:message1">
                                                <f:setPropertyActionListener value="#{configParametrosEvaluacion}" target="#{configuracionesController.configuracionParametrosEvaluacionSelected}"/>
                                            </p:commandButton>

                                        </p:column>                                           
                                        <p:column headerText="Editar" width="35" style ="text-align: center">
                                            <p:commandButton icon="ui-icon-pencil"
                                                             title="Editar el registro"
                                                             update="formPrincipal:panelEdicionConfigParametrosEvaluacion, :formPrincipal:message1"
                                                             action="#{configuracionesController.seleccionarEditarConfigParametroEvaluacion}"
                                                             >
                                                <f:setPropertyActionListener value="#{configParametrosEvaluacion}" target="#{configuracionesController.configuracionParametrosEvaluacionSelected}"/>
                                                <f:setPropertyActionListener value="#{null}" target="#{configuracionesController.valoracionParametroEvaluacionSelected}"/>
                                            </p:commandButton>
                                        </p:column>
                                        <p:column headerText="Eliminar " style="width: 50px; text-align: center" >
                                            <p:commandButton style="margin: 0" title="Eliminar el registro" icon="ui-icon-trash" 
                                                             process="@this"
                                                             onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                             action="#{configuracionesController.eliminarConfigParametroEvaluacion()}"
                                                             update="formPrincipal:panelConfigParametrosEvaluacion, :formPrincipal:message1 ">
                                                <f:setPropertyActionListener value="#{configParametrosEvaluacion}" target="#{configuracionesController.configuracionParametrosEvaluacionSelected}" />
                                                <p:confirm header="Confirmación" message="Confirma que desea eliminar la configuración seleccionada?" icon="ui-icon-alert" />
                                            </p:commandButton>  
                                        </p:column>


                                        <p:rowExpansion >
                                            <p:panel style="border:hidden;width:88%; padding-left: 30px"  >
                                                <h:outputLabel value="Parámetros de evaluación:" style="font-weight: bold"/>
                                                <p:commandButton value="" title="Agregar" icon="ui-icon-plus"
                                                                 style="width: 30px; height: 20px"
                                                                 action="#{configuracionesController.nuevoParametroEvaluacion}"
                                                                 update=":formPrincipal:panelEdicionConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                 >
                                                    <f:setPropertyActionListener value="#{configParametrosEvaluacion}" target="#{configuracionesController.configuracionParametrosEvaluacionSelected}"/>
                                                    <f:setPropertyActionListener value="#{null}" target="#{configuracionesController.parametroEvaluacionPadreSelected}"/>
                                                </p:commandButton>

                                                <p:dataTable id="dtParametroEvaluacion" value="#{configParametrosEvaluacion.parametroEvaluacionList}" var="paramEvaluacion"
                                                             expandedRow="#{paramEvaluacion.expanded}"
                                                             resizableColumns="true"
                                                             emptyMessage="No se encontraron Resultados"> 
                                                    <p:ajax event="rowToggle" listener="#{configuracionesController.onRowToggleParametroEvaluacion}"/>
                                                    <p:column width="20" >
                                                        <p:rowToggler/>
                                                    </p:column>
                                                    <p:column headerText="Nro." width="40">
                                                        <table style="width: 40px">
                                                            <tr>
                                                                <td style="padding: 0px; text-align: center; border: hidden">
                                                                    <h:outputText value="#{paramEvaluacion.orden}" />
                                                                </td>
                                                                <td style="padding: 0px; border: hidden">
                                                                    <table style="width: 20px">
                                                                        <tr>
                                                                            <td style="padding: 0px; border: hidden">
                                                                                <p:commandButton icon="ui-icon-triangle-1-n"
                                                                                                 disabled="#{paramEvaluacion.orden==1}"
                                                                                                 style="width: 20px; height: 15px"
                                                                                                 onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                                                                 title="Cambiar orden(Subir)" action="#{configuracionesController.cambiarOrdenParametroEvaluacion(paramEvaluacion, -1)}" 
                                                                                                 update=":formPrincipal:dtConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                                 >
                                                                                </p:commandButton>                         
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td style="padding: 0px; border: hidden">
                                                                                <p:commandButton icon="ui-icon-triangle-1-s"
                                                                                                 disabled="#{paramEvaluacion.orden==configParametrosEvaluacion.parametroEvaluacionList.size()}"
                                                                                                 style="width: 20px; height: 15px"
                                                                                                 onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                                                                 title="Cambiar orden(Bajar)" action="#{configuracionesController.cambiarOrdenParametroEvaluacion(paramEvaluacion,1)}"
                                                                                                 update=":formPrincipal:dtConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                                 >
                                                                                </p:commandButton>                                                        
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                            </tr>
                                                        </table>                                                                    
                                                    </p:column>
                                                    <p:column headerText="Descripción" style="white-space: pre-line">
                                                        <h:outputText value="#{paramEvaluacion.descripcion}" ></h:outputText>
                                                    </p:column>
                                                    <p:column headerText="Tiene SubParámetros ?" width="120" style="text-align: center">
                                                        <h:outputText value="#{paramEvaluacion.tieneSubitems=='S'?'Si':'No'}"></h:outputText>
                                                    </p:column>
                                                    <p:column headerText="Puntaje Máximo" width="80" style="text-align: center">
                                                        <h:outputText value="#{paramEvaluacion.puntajeMaximo}" rendered="#{paramEvaluacion.tieneSubitems=='N'}">
                                                            <f:convertNumber locale="es"  pattern="#,###,##0.00" />
                                                        </h:outputText>
                                                    </p:column>



                                                    <p:column headerText="Editar" width="35" style ="text-align: center">
                                                        <p:commandButton icon="ui-icon-pencil"
                                                                         title="Editar el registro"
                                                                         update="formPrincipal:panelEdicionConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                         action="#{configuracionesController.seleccionarEditarParametroEvaluacion}"
                                                                         >
                                                            <f:setPropertyActionListener value="#{null}" target="#{configuracionesController.configuracionParametrosEvaluacionSelected}"/>
                                                            <f:setPropertyActionListener value="#{paramEvaluacion}" target="#{configuracionesController.parametroEvaluacionSelected}"/>
                                                            <f:setPropertyActionListener value="#{null}" target="#{configuracionesController.valoracionParametroEvaluacionSelected}"/>
                                                        </p:commandButton>

                                                    </p:column>                                         

                                                    <p:column headerText="Eliminar " style="width: 50px; text-align: center" >
                                                        <p:commandButton style="margin: 0" title="Eliminar el registro" icon="ui-icon-trash" 
                                                                         process="@this"
                                                                         action="#{configuracionesController.eliminarParametroEvaluacion()}"
                                                                         update="formPrincipal:panelConfigParametrosEvaluacion, :formPrincipal:message1 ">
                                                            <f:setPropertyActionListener value="#{configParametrosEvaluacion}" target="#{configuracionesController.configuracionParametrosEvaluacionSelected}" />
                                                            <f:setPropertyActionListener value="#{paramEvaluacion}" target="#{configuracionesController.parametroEvaluacionSelected}" />
                                                            <p:confirm header="Confirmación" message="Confirma que desea eliminar el parámetro de evaluación seleccionado?" icon="ui-icon-alert" />
                                                        </p:commandButton>  
                                                    </p:column>



                                                    <p:rowExpansion  >
                                                        <p:panel style="border:hidden;width:98%; padding-left: 30px"  rendered="#{paramEvaluacion.tieneSubitems=='N'}">
                                                            <h:outputLabel value="Opciones de respuesta:" style="font-weight: bold"/>
                                                            <p:commandButton value="" title="Agregar" icon="ui-icon-plus"
                                                                             style="width: 30px; height: 20px"
                                                                             action="#{configuracionesController.nuevoValoracionParametro}"
                                                                             update=":formPrincipal:panelEdicionConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                             >
                                                                <f:setPropertyActionListener value="#{paramEvaluacion}" target="#{configuracionesController.parametroEvaluacionSelected}"/>
                                                            </p:commandButton>

                                                            <p:dataTable value="#{paramEvaluacion.valoracionList}" var="valoracionParam"
                                                                         emptyMessage="No se encontraron resultados"
                                                                         rowIndexVar="index" style="width: 70%; padding-left: 30px">
                                                                <p:column headerText="Nro." style="width:40px">
                                                                    <table style="width: 40px">
                                                                        <tr>
                                                                            <td style="padding: 0px; text-align: center; border: hidden">
                                                                                <h:outputText value="#{valoracionParam.orden}" />
                                                                            </td>
                                                                            <td style="padding: 0px; border: hidden">
                                                                                <table style="width: 20px">
                                                                                    <tr>
                                                                                        <td style="padding: 0px; border: hidden">
                                                                                            <p:commandButton icon="ui-icon-triangle-1-n"
                                                                                                             disabled="#{valoracionParam.orden==1}"
                                                                                                             style="width: 20px; height: 15px"
                                                                                                             onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                                                                             title="Cambiar orden(Subir)" action="#{configuracionesController.cambiarOrdenValoracionParametroEvaluacion(valoracionParam,-1)}" 
                                                                                                             update=":formPrincipal:dtConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                                             >
                                                                                            </p:commandButton>                         
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td style="padding: 0px; border: hidden">
                                                                                            <p:commandButton icon="ui-icon-triangle-1-s"
                                                                                                             disabled="#{valoracionParam.orden==paramEvaluacion.valoracionList.size()}"
                                                                                                             style="width: 20px; height: 15px"
                                                                                                             onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                                                                             title="Cambiar orden(Bajar)" action="#{configuracionesController.cambiarOrdenValoracionParametroEvaluacion(valoracionParam,1)}"
                                                                                                             update=":formPrincipal:dtConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                                             >
                                                                                            </p:commandButton>                                                        
                                                                                        </td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                    </table>                                                                    
                                                                </p:column>
                                                                <p:column headerText="Descripción">
                                                                    <h:outputText value="#{valoracionParam.descripcion}" style="white-space: pre-line"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Puntaje" width="50" style="text-align: center">
                                                                    <h:outputText value="#{valoracionParam.puntaje}" style="white-space: pre-line">
                                                                        <f:convertNumber locale="es"  pattern="#,###,##0.00" />
                                                                    </h:outputText>
                                                                </p:column>

                                                                <p:column headerText="Editar" width="35" style ="text-align: center">
                                                                    <p:commandButton icon="ui-icon-pencil"
                                                                                     title="Editar el registro"
                                                                                     update="formPrincipal:panelEdicionConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                     action="#{configuracionesController.seleccionarEditarValoracionParametroEvaluacion}"
                                                                                     >
                                                                        <f:setPropertyActionListener value="#{valoracionParam}" target="#{configuracionesController.valoracionParametroEvaluacionSelected}"/>
                                                                    </p:commandButton>

                                                                </p:column>                                         

                                                                <p:column headerText="Eliminar " style="width: 50px; text-align: center" >
                                                                    <p:commandButton style="margin: 0" title="Eliminar el registro" icon="ui-icon-trash" 
                                                                                     process="@this"
                                                                                     onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                                                     action="#{configuracionesController.eliminarValoracionParametroEvaluacion}"
                                                                                     update=":formPrincipal:panelConfigParametrosEvaluacion, :formPrincipal:message1 ">
                                                                        <f:setPropertyActionListener value="#{valoracionParam}" target="#{configuracionesController.valoracionParametroEvaluacionSelected}" />
                                                                        <f:setPropertyActionListener value="#{paramEvaluacion}" target="#{configuracionesController.parametroEvaluacionSelected}" />
                                                                        <p:confirm header="Confirmación" message="Está seguro que desea eliminar el item seleccionado ?" icon="ui-icon-alert" />
                                                                    </p:commandButton>  
                                                                </p:column>

                                                            </p:dataTable>
                                                        </p:panel>                                            

                                                        <p:panel style="border:hidden;width:98%; padding-left: 30px"  rendered="#{paramEvaluacion.tieneSubitems=='S'}">
                                                            <h:outputLabel value="Parámetros de evaluación:" style="font-weight: bold"/>
                                                            <p:commandButton value="" title="Agregar" icon="ui-icon-plus"
                                                                             style="width: 30px; height: 20px"
                                                                             action="#{configuracionesController.nuevoParametroEvaluacion}"
                                                                             update=":formPrincipal:panelEdicionConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                             >
                                                                <f:setPropertyActionListener value="#{null}" target="#{configuracionesController.configuracionParametrosEvaluacionSelected}"/>
                                                                <f:setPropertyActionListener value="#{paramEvaluacion}" target="#{configuracionesController.parametroEvaluacionPadreSelected}"/>
                                                            </p:commandButton>

                                                            <p:dataTable id="dtParametroEvaluacionHijo" value="#{paramEvaluacion.parametroEvaluacionList}" var="paramEvaluacionHijo"
                                                                         expandedRow="#{paramEvaluacionHijo.expanded}"
                                                                         resizableColumns="true"
                                                                         emptyMessage="No se encontraron Resultados"> 
                                                                <p:ajax event="rowToggle" listener="#{configuracionesController.onRowToggleParametroEvaluacionHijo}"/>
                                                                <p:column width="20" >
                                                                    <p:rowToggler/>
                                                                </p:column>
                                                                <p:column headerText="Nro." width="40">
                                                                    <table style="width: 40px">
                                                                        <tr>
                                                                            <td style="padding: 0px; text-align: center; border: hidden">
                                                                                <h:outputText value="#{paramEvaluacionHijo.orden}" />
                                                                            </td>
                                                                            <td style="padding: 0px; border: hidden">
                                                                                <table style="width: 20px">
                                                                                    <tr>
                                                                                        <td style="padding: 0px; border: hidden">
                                                                                            <p:commandButton icon="ui-icon-triangle-1-n"
                                                                                                             disabled="#{paramEvaluacionHijo.orden==1}"
                                                                                                             style="width: 20px; height: 15px"
                                                                                                             onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                                                                             title="Cambiar orden(Subir)" action="#{configuracionesController.cambiarOrdenParametroEvaluacion(paramEvaluacionHijo, -1)}" 
                                                                                                             update=":formPrincipal:dtConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                                             >
                                                                                            </p:commandButton>                         
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td style="padding: 0px; border: hidden">
                                                                                            <p:commandButton icon="ui-icon-triangle-1-s"
                                                                                                             disabled="#{paramEvaluacionHijo.orden==paramEvaluacion.parametroEvaluacionList.size()}"
                                                                                                             style="width: 20px; height: 15px"
                                                                                                             onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                                                                             title="Cambiar orden(Bajar)" action="#{configuracionesController.cambiarOrdenParametroEvaluacion(paramEvaluacionHijo,1)}"
                                                                                                             update=":formPrincipal:dtConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                                             >
                                                                                            </p:commandButton>                                                        
                                                                                        </td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                    </table>                                                                    
                                                                </p:column>
                                                                <p:column headerText="Descripción" style="white-space: pre-line">
                                                                    <h:outputText value="#{paramEvaluacionHijo.descripcion}" ></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Puntaje Máximo" width="80" style="text-align: center">
                                                                    <h:outputText value="#{paramEvaluacionHijo.puntajeMaximo}" rendered="#{paramEvaluacionHijo.tieneSubitems=='N'}">
                                                                        <f:convertNumber locale="es"  pattern="#,###,##0.00" />
                                                                    </h:outputText>
                                                                </p:column>



                                                                <p:column headerText="Editar" width="35" style ="text-align: center">
                                                                    <p:commandButton icon="ui-icon-pencil"
                                                                                     title="Editar el registro"
                                                                                     update="formPrincipal:panelEdicionConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                     action="#{configuracionesController.seleccionarEditarParametroEvaluacion}"
                                                                                     >
                                                                        <f:setPropertyActionListener value="#{null}" target="#{configuracionesController.configuracionParametrosEvaluacionSelected}"/>
                                                                        <f:setPropertyActionListener value="#{paramEvaluacionHijo}" target="#{configuracionesController.parametroEvaluacionSelected}"/>
                                                                        <f:setPropertyActionListener value="#{null}" target="#{configuracionesController.valoracionParametroEvaluacionSelected}"/>
                                                                    </p:commandButton>

                                                                </p:column>                                         

                                                                <p:column headerText="Eliminar " style="width: 50px; text-align: center" >
                                                                    <p:commandButton style="margin: 0" title="Eliminar el registro" icon="ui-icon-trash" 
                                                                                     process="@this"
                                                                                     action="#{configuracionesController.eliminarParametroEvaluacion()}"
                                                                                     update="formPrincipal:panelConfigParametrosEvaluacion, :formPrincipal:message1 ">
                                                                        <f:setPropertyActionListener value="#{configParametrosEvaluacion}" target="#{configuracionesController.configuracionParametrosEvaluacionSelected}" />
                                                                        <f:setPropertyActionListener value="#{paramEvaluacionHijo}" target="#{configuracionesController.parametroEvaluacionSelected}" />
                                                                        <p:confirm header="Confirmación" message="Confirma que desea eliminar el parámetro de evaluación seleccionado?" icon="ui-icon-alert" />
                                                                    </p:commandButton>  
                                                                </p:column>
                                                                <p:rowExpansion  >
                                                                    <p:panel style="border:hidden;width:98%; padding-left: 30px">
                                                                        <h:outputLabel value="Opciones de respuesta:" style="font-weight: bold"/>
                                                                        <p:commandButton value="" title="Agregar" icon="ui-icon-plus"
                                                                                         style="width: 30px; height: 20px"
                                                                                         action="#{configuracionesController.nuevoValoracionParametro}"
                                                                                         update=":formPrincipal:panelEdicionConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                         >
                                                                            <f:setPropertyActionListener value="#{paramEvaluacionHijo}" target="#{configuracionesController.parametroEvaluacionSelected}"/>
                                                                        </p:commandButton>

                                                                        <p:dataTable value="#{paramEvaluacionHijo.valoracionList}" var="valoracionParamHijo"
                                                                                     emptyMessage="No se encontraron resultados"
                                                                                     rowIndexVar="index" style="width: 70%; padding-left: 30px">
                                                                            <p:column headerText="Nro." style="width:40px">
                                                                                <table style="width: 40px">
                                                                                    <tr>
                                                                                        <td style="padding: 0px; text-align: center; border: hidden">
                                                                                            <h:outputText value="#{valoracionParamHijo.orden}" />
                                                                                        </td>
                                                                                        <td style="padding: 0px; border: hidden">
                                                                                            <table style="width: 20px">
                                                                                                <tr>
                                                                                                    <td style="padding: 0px; border: hidden">
                                                                                                        <p:commandButton icon="ui-icon-triangle-1-n"
                                                                                                                         disabled="#{valoracionParamHijo.orden==1}"
                                                                                                                         style="width: 20px; height: 15px"
                                                                                                                         onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                                                                                         title="Cambiar orden(Subir)" action="#{configuracionesController.cambiarOrdenValoracionParametroEvaluacion(valoracionParamHijo,-1)}" 
                                                                                                                         update=":formPrincipal:dtConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                                                         >
                                                                                                        </p:commandButton>                         
                                                                                                    </td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td style="padding: 0px; border: hidden">
                                                                                                        <p:commandButton icon="ui-icon-triangle-1-s"
                                                                                                                         disabled="#{valoracionParamHijo.orden==paramEvaluacionHijo.valoracionList.size()}"
                                                                                                                         style="width: 20px; height: 15px"
                                                                                                                         onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                                                                                         title="Cambiar orden(Bajar)" action="#{configuracionesController.cambiarOrdenValoracionParametroEvaluacion(valoracionParamHijo,1)}"
                                                                                                                         update=":formPrincipal:dtConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                                                         >
                                                                                                        </p:commandButton>                                                        
                                                                                                    </td>
                                                                                                </tr>
                                                                                            </table>
                                                                                        </td>
                                                                                    </tr>
                                                                                </table>                                                                    
                                                                            </p:column>
                                                                            <p:column headerText="Descripción">
                                                                                <h:outputText value="#{valoracionParamHijo.descripcion}" style="white-space: pre-line"></h:outputText>
                                                                            </p:column>
                                                                            <p:column headerText="Puntaje" width="50" style="text-align: center">
                                                                                <h:outputText value="#{valoracionParamHijo.puntaje}" style="white-space: pre-line">
                                                                                    <f:convertNumber locale="es"  pattern="#,###,##0.00" />
                                                                                </h:outputText>
                                                                            </p:column>

                                                                            <p:column headerText="Editar" width="35" style ="text-align: center">
                                                                                <p:commandButton icon="ui-icon-pencil"
                                                                                                 title="Editar el registro"
                                                                                                 update="formPrincipal:panelEdicionConfigParametrosEvaluacion, :formPrincipal:message1"
                                                                                                 action="#{configuracionesController.seleccionarEditarValoracionParametroEvaluacion}"
                                                                                                 >
                                                                                    <f:setPropertyActionListener value="#{valoracionParamHijo}" target="#{configuracionesController.valoracionParametroEvaluacionSelected}"/>
                                                                                </p:commandButton>

                                                                            </p:column>                                         

                                                                            <p:column headerText="Eliminar " style="width: 50px; text-align: center" >
                                                                                <p:commandButton style="margin: 0" title="Eliminar el registro" icon="ui-icon-trash" 
                                                                                                 process="@this"
                                                                                                 onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()"
                                                                                                 action="#{configuracionesController.eliminarValoracionParametroEvaluacion}"
                                                                                                 update=":formPrincipal:panelConfigParametrosEvaluacion, :formPrincipal:message1 ">
                                                                                    <f:setPropertyActionListener value="#{valoracionParamHijo}" target="#{configuracionesController.valoracionParametroEvaluacionSelected}" />
                                                                                    <f:setPropertyActionListener value="#{paramEvaluacionHijo}" target="#{configuracionesController.parametroEvaluacionSelected}" />
                                                                                    <p:confirm header="Confirmación" message="Está seguro que desea eliminar el item seleccionado ?" icon="ui-icon-alert" />
                                                                                </p:commandButton>  
                                                                            </p:column>

                                                                        </p:dataTable>
                                                                    </p:panel>                                            
                                                                </p:rowExpansion>
                                                            </p:dataTable>
                                                        </p:panel>                                                               
                                                    </p:rowExpansion>                                        

                                                </p:dataTable>                                                                                          
                                            </p:panel>                                                
                                        </p:rowExpansion>                      

                                    </p:dataTable>                                               

                                </h:panelGrid>                              


                            </p:panel>                                   

                        </p:panel>

                    </h:panelGrid>
                </p:panel>

            </ui:define>
        </ui:composition>
    </h:body>
</html>

